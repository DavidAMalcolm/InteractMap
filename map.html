<!DOCTYPE html>
<html>
<head>
    <title>Grace International Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map { height: 600px; }
        .popup-content { max-width: 200px; } /* Set a maximum width for the popup content */
        .parish-label {
            background: none; 
            border: none; 
            font-size: 18px; 
            font-weight: bold; 
            color: #fff; 
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-ajax/dist/leaflet.ajax.min.js"></script>
    <script>
        // Initialize the map centered on Jamaica and disable zoom controls
        var map = L.map('map', {
            center: [18.1096, -77.2975], // Coordinates for Jamaica
            zoom: 9, // Zoom level to focus on Jamaica
            zoomControl: false, // Disable zoom controls
            scrollWheelZoom: false, // Disable zooming with mouse wheel
            doubleClickZoom: false, // Disable zooming with double click
            dragging: false // Disable dragging the map
        });
        L.tileLayer('https://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.jpg', {
        }).addTo(map);

        // Define the locations with details, including facts where provided.
        var locations = [
            {lat: 17.9797, lng: -76.9447, name: 'Grace Distribution Center', image: './GraceDC.jpg', facts: "<b>Facts:</b><ul><li>Located at Salt Pond Road, Spanish Town</li><li>Key logistics hub for GraceKennedy</li></ul>"},
            {lat: 18.2191, lng: -78.1334, name: 'Grace Foods Processor Division', image: './GraceSav.jpg', facts: "<b>Facts:</b><ul><li>Located at 6 Paradise Road, Savanna-la-mar</li><li>Manufactures a variety of food products</li></ul>"},
            {lat: 17.9662, lng: -76.7932, name: 'GraceKennedy Foods Head Office', image: './GraceFoodHO.jpg', facts: "<b>Facts:</b><ul><li>Located at 42-56 Harbour St, Kingston</li><li>Headquarters of GraceKennedy Foods</li></ul>"}
        ];

        // Create a bounds object to store the coordinates of all markers.
        var bounds = L.latLngBounds();

        // Loop through each location and add a marker with a popup.
        locations.forEach(function(location) {
            var marker = L.marker([location.lat, location.lng]).addTo(map); // Use default marker
            
            // Extend the bounds to include this marker's coordinates.
            bounds.extend([location.lat, location.lng]);
            
            // Create the popup content with a centered image of fixed size.
            var popupContent = '<div class="popup-content"><b>' + location.name + '</b><br>' +
                               '<img src="' + location.image + '" alt="' + location.name + 
                               '" style="width:150px;height:100px;display:block;margin:0 auto; margin-top:10px;"><br>';
            
            // Check if facts are provided; handle string or array.
            if (location.facts) {
                if (Array.isArray(location.facts)) {
                    popupContent += location.facts.join('<br>');
                } else {
                    popupContent += location.facts;
                }
            }
            
            popupContent += '</div>';
            marker.bindPopup(popupContent);
        });

        // Load GeoJSON data for Jamaica's parishes and add it to the map
        var countryGeoJsonUrl = 'jm.json'; // Replace with the actual URL to the GeoJSON file
        var countryOverlay = new L.GeoJSON.AJAX(countryGeoJsonUrl, {
            style: function (feature) {
                return {
                    color: "#fff", // Boundary line color
                    weight: 2, // Boundary line width
                    fillColor: "#FF4444", // Less intense red fill color
                    fillOpacity: 1.0 // Fill opacity
                };
            },
            onEachFeature: function (feature, layer) {
                if (feature.properties && feature.properties.name) {
                    layer.bindTooltip(feature.properties.name, {
                        direction: 'center',
                        className: 'parish-label'
                    });
                }
            }
        }).addTo(map);
    </script>
</body>
</html>
